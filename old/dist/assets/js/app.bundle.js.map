{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Character.js","webpack:///./src/PlayersDash.js","webpack:///./src/Story.js","webpack:///./src/Terminal.js","webpack:///./src/Tools.js","webpack:///./src/index.js"],"names":["tools","require","Character","name","type","race","level","class","stats","str","dex","con","int","wis","chr","baseStats","initative","speed","armourClass","baseHP","maxHP","tempHP","shown","colors","hp","json","Object","keys","k","create","stat","modifiers","s","makeFlexVDN","setDim","setMargin","left","right","addChild","makeIconVDN","container","addText","subtitle","terminal","icons","top","bottom","map","x","cs","child","bind","autoType","mods","modifier","modText","makeDivVDN","style","borderTop","p","HP","percentage","color","pbc","className","children","width","height","t","heading","first","innerText","makeCharacterStats","borderBottom","marginBottom","throwModal","attributes","throwFull","root","VDN","makeCharacterActionbar","makeCharacterHeader","makeBaseStats","makeCharacterSubHeading","makeCharacterHP","render","Math","ceil","points","floor","module","exports","PlayersDash","anchors","cards","characterList","n","character","toLowerCase","match","watched","c","push","card","display","innerHTML","characterSet","filter","length","slice","i","borderTopColor","appendChild","Story","contentAnchor","titleAnchor","progressAnchor","currentChapter","characters","chapters","bootstrapColors","ch","raw","replace","jmpIcon","m","g1","g2","o","col","indexOf","g","console","log","chapter","renderedContent","markdownify","title","links","document","getElementsByClassName","e","addEventListener","jump","parseInt","id","split","Terminal","inputAnchor","outputAnchor","output","input","scrollPos","playersDash","commands","rollDice","clear","testCommand","statCheck","pos","history","event","registerKeyDown","key","keyCode","charCode","value","execute","result","createElement","fontSize","margin","clientHeight","scrollTop","cmd","l","exec","writeError","execString","args","player","getCharacter","base","getRndInteger","abilityMod","abilityCheck","saveMod","savingThrow","abilityRoll","saveRoll","writeOutput","d","rolls","Array","fill","sum","join","modalVDN","change","handler","set","obj","prop","Proxy","tagName","events","tag","second","w","h","marginLeft","marginRight","marginTop","text","size","setAttribute","dir","jc","ai","div","flexDirection","justifyContent","alignItems","tt","a","icon","min","max","random","reduce","v","closeModal","toDie","getElementById","body","removeChild","undefined","padding","test_story","story","storyDriver","content","progress","loadFromJson","next","prev","terminalDriver","playersDashDriver","buildFromJson","newCharacter","init","dev","socket","io","connect","on","window","onload"],"mappings":"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","file":"app.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","const tools = require('./Tools')\n\nclass Character {\n  constructor() {\n    this.name = null;\n    this.type = null;\n    this.race = null;\n    this.level = null;\n    this.class = null;\n    this.stats = {\n      str:null,\n      dex:null,\n      con:null,\n      int:null,\n      wis:null,\n      chr:null\n    };\n    this.baseStats = {\n      initative: null,\n      speed: null,\n      armourClass: null\n    };\n    this.baseHP = 0;\n    this.maxHP = null;\n    this.tempHP = 0;\n    this.shown = false;\n    this.colors = {\n      \"HP\": (hp) => {\n        if (hp >= 50) return \"bg-success\";\n        if (hp >= 20) return \"bg-warning\";\n        return \"bg-danger\";\n      }\n    }\n  }\n  buildFromJson(json) {\n    for(let k of Object.keys(json)) {\n      if(typeof json[k] == \"object\")\n        this[k] = Object.create(json[k]);\n      else\n        this[k] = json[k];\n    }\n  }\n  abilityCheck(stat) {\n    return this.modifiers[stat];\n  }\n  savingThrow(stat) {\n    return this.modifiers[stat];\n  }\n  giveTempHP(s) {\n    if (s < 0) s = 0;\n    this.tempHP = s;\n    this.baseHP += this.tempHP;\n  }\n  clearState() {\n    this.tempHP = 0\n    if(this.baseHP > this.maxHP) this.baseHP = this.maxHP;\n  }\n  set HP(s) {\n    if (s<0) {\n      this.baseHP = 0;\n      return;\n    }\n    if (s > (this.maxHP+this.tempHP)) this.baseHP = (this.maxHP+this.tempHP);\n    else this.baseHP = s;\n  }\n  get HP() {\n    let p = Math.ceil(this.baseHP/(this.maxHP+this.tempHP)*100);\n    return {\n      points: this.baseHP,\n      percentage: p\n    };\n  }\n  get modifiers() {\n    return {\n      str:Math.floor(this.stats.str/2)-5,\n      dex:Math.floor(this.stats.dex/2)-5,\n      con:Math.floor(this.stats.con/2)-5,\n      int:Math.floor(this.stats.int/2)-5,\n      wis:Math.floor(this.stats.wis/2)-5,\n      chr:Math.floor(this.stats.chr/2)-5\n    };\n  }\n\n  makeBaseStats() {\n    let baseStats = tools.makeFlexVDN(\"row\",\"space-around\",\"center\");\n    baseStats.setDim(\"calc(100% - 2rem)\",\"15%\");\n    baseStats.setMargin({left:\"1rem\",right:\"1rem\"});\n    baseStats.addChild(tools.makeIconVDN(\"shield\",\"AC\"));\n    return baseStats;\n  }\n\n  makeCharacterHeader() {\n      let container = tools.makeFlexVDN(\"column\",\"center\",\"center\");\n      container.setDim(\"100%\",\"25%\")\n      container.addText(\"h6\",this.name,\"\",\"1rem\");\n      let subtitle = `Level ${this.level} ${this.race} ${this.class}`;\n      container.addText(\"p\",subtitle,\"lead\",\"0.8rem\");\n      return container;\n  }\n\n  makeCharacterStats(terminal) {\n    let icons = tools.makeFlexVDN(\"row\",\"space-between\",\"center\");\n    icons.setDim(\"calc(100% - 2rem)\",\"26%\");\n    icons.setMargin({top:\"1%\",bottom:\"0%\",left:\"1rem\",right:\"1rem\"});\n    let stats = {\n      \"str\":\"sword\",\n      \"dex\":\"run-fast\",\n      \"con\":\"heart-half-full\",\n      \"int\":\"atom\",\n      \"wis\":\"earth\",\n      \"chr\":\"forum\"\n    }\n    Object.keys(stats).map((x)=>{\n      let cs = this.stats[x];\n      let child = tools.makeIconVDN(stats[x],`${x}: ${cs}`);\n      child.bind(\"click\",()=>terminal.autoType(`${x} check for [${this.name}]`))\n      icons.addChild(child);\n    })\n    let mods = tools.makeFlexVDN(\"row\",\"space-between\",\"center\");\n    mods.setDim(\"calc(100% - 2rem)\",\"26%\");\n    mods.setMargin({top:\"1%\",left:\"1rem\",right:\"1rem\"});\n    Object.keys(stats).map((x)=>{\n      let modifier = this.modifiers[x];\n      let modText = null;\n      if (modifier > 0)\n        modText = tools.makeDivVDN().addText(\"p\",`+${modifier}`,\"lead faint text-success\",\"0.7rem\");\n      else if (modifier < 0)\n        modText = tools.makeDivVDN().addText(\"p\",`${modifier}`,\"lead faint text-danger\",\"0.7rem\");\n      else\n        modText = tools.makeDivVDN().addText(\"p\",`${modifier}`,\"lead faint\",\"0.7rem\");\n      mods.addChild(modText)\n    })\n    let container = tools.makeFlexVDN(\"column\",\"center\",\"center\");\n    container.setMargin({top:\"2%\",left:\"1rem\",right:\"1rem\"});\n    container.addChild(icons);\n    container.addChild(mods);\n    container.style.borderTop = \"solid #EBEBEB 2px\";\n    return container;\n  }\n\n  makeCharacterHP() {\n    let p = this.HP.percentage;\n    let color = this.colors.HP(p);\n    let container = tools.makeDivVDN().setDim(\"calc(100% - 2rem)\",\"0.3rem\");\n    container.setMargin({left: \"1rem\",right: \"1rem\"});\n    let pbc = tools.makeDivVDN({className:\"progress\"});\n    pbc.setDim(\"100%\",\"100%\");\n    pbc.addChild(tools.makeDivVDN({className:`progress-bar ${color}`}));\n    pbc.children[0].style.width = p+\"%\";\n    pbc.children[0].style.height = \"100%\";\n    container.addChild(pbc);\n    return container;\n  }\n\n  makeCharacterSubHeading(t) {\n    let container = tools.makeDivVDN();\n    container.addText(\"p\",t,\"lead\",\"0.8rem\");\n    container.setMargin({left:\"1.5rem\",top:\"1rem\",bottom:\"0.4rem\"});\n    return container;\n  }\n  throwFull() {\n    let container = tools.makeFlexVDN(\"column\",\"center\",\"center\");\n    container.setDim(\"100%\",\"100%\");\n\n    let subtitle = `Level ${this.level} ${this.race} ${this.class}`;\n\n\n    let heading = tools.makeFlexVDN(\"row\",\"center\",\"center\");\n    heading.setDim(\"calc(100% - 2rem)\",\"4rem\");\n    heading.setMargin({left: \"1rem\",right:\"1rem\",bottom:\"1rem\"});\n    heading.addChild(tools.makeDivVDN());\n    heading.first.innerText = this.name;\n    heading.first.style[\"font-size\"] = \"2rem\";\n    heading.addText(\"p\",subtitle,\"lead\",\"1rem\");\n    container.addChild(heading);\n\n    let stats = this.makeCharacterStats();\n    stats.style.width = \"calc(100% - 2rem)\";\n    stats.children[0].children.map((x)=>{\n      x.children[0].style[\"font-size\"] = \"1.2rem\";\n    });\n    stats.children[1].children.map((x)=>{\n      x.children[0].style[\"font-size\"] = \"1rem\";\n    });\n    stats.setMargin({left: \"1rem\",right:\"1rem\"});\n    stats.style.borderBottom = \"#EBEBEB 2px solid\";\n    stats.children[1].style.marginBottom = \"1%\";\n\n\n    container.addChild(stats);\n    tools.throwModal(container);\n  }\n  makeCharacterActionbar() {\n    let container = tools.makeFlexVDN(\"row\",\"flex-end\",\"center\");\n    container.setMargin({left:\"0.5rem\",right:\"0.5rem\"});\n    container.setDim(\"calc(100% - 1rem)\",\"1.5rem\");\n    let child = tools.makeIconVDN(\"arrow-expand\",`expand`);\n    child.attributes[\"data-balloon-pos\"] = \"left\";\n    child.bind(\"click\",()=>this.throwFull());\n    container.addChild(child);\n    return container;\n  }\n  render(terminal) {\n    let root = tools.VDN(\"div\");\n    root.addChild(this.makeCharacterActionbar());\n    root.addChild(this.makeCharacterHeader());\n    root.addChild(this.makeBaseStats());\n    root.addChild(this.makeCharacterStats(terminal));\n    root.addChild(this.makeCharacterSubHeading(\"HP\"));\n    root.addChild(this.makeCharacterHP());\n    return root.render();\n  }\n}\n\nmodule.exports = Character\n","const Character = require('./Character')\nconst tools = require('./Tools')\n\nclass PlayersDash {\n  constructor(anchors, terminal){\n    this.cards = anchors;\n    this.characterList = [];\n    this.terminal = terminal;\n    this.colors = {\n      \"NPC\": \"var(--info)\",\n      \"Player\": \"var(--success)\",\n      \"Enemy\": \"var(--danger)\"\n    }\n  }\n\n  getCharacter(n) {\n    for(let character of this.characterList) {\n      if(character.name.toLowerCase().match(n))\n        return tools.watched(character,this.render);\n    }\n    return null;\n  }\n\n  newCharacter(c) {\n    this.characterList.push(c);\n    this.render();\n  }\n\n  render() {\n      // hide and clear\n      this.cards.map((card) => {\n        card.style.display = \"none\";\n        card.innerHTML = \"\";\n      });\n\n      // get characters\n      let characterSet = this.characterList.filter((x)=>x.shown);\n      if(characterSet.length > this.cards.length)\n        characterSet = characterSet.slice(0,this.cards.length);\n\n      // build card from sub components\n      this.cards.map((card,i)=>{\n        if (i <= characterSet.length - 1) {\n          card.style.borderTopColor = this.colors[characterSet[i].type];\n          card.appendChild(characterSet[i].render(this.terminal));\n        }\n      });\n\n      // display\n      this.cards.map((x)=>x.style.display = \"block\");\n  }\n}\n\nmodule.exports = PlayersDash\n","const tools = require('./Tools')\n\nclass Story {\n  constructor(contentAnchor,titleAnchor,progressAnchor){\n    this.contentAnchor = contentAnchor\n    this.titleAnchor = titleAnchor\n    this.progressAnchor = progressAnchor\n    this.currentChapter = null\n    this.characters = []\n    this.chapters = []\n    this.bootstrapColors = [\n      \"danger\",\n      \"success\",\n      \"warning\",\n      \"info\",\n      \"primary\",\n      \"secondary\"\n    ]\n  }\n  loadFromJson(json){\n    this.chapters = json.chapters\n    this.currentChapter = json.currentChapter\n    this.characters = json.characters\n  }\n  markdownify(ch) {\n    let raw = this.chapters[ch].raw\n    raw = raw.replace(/_(.*?)_/gi,\"<i>$1</i>\").replace(/\\*(.*?)\\*/gi,\"<b>$1</b>\")\n    raw = raw.replace(/\\-\\-\\-+/gi,\"<hr>\")\n    let jmpIcon = \"<a data-balloon='Chapter $1' data-balloon-pos='up'><i class='mdi mdi-share chapter-link jmp-link' id='jmp-link-$1'></i><a><br>\"\n    raw = raw.replace(/\\<(\\d+)\\>/gi,jmpIcon)\n    raw = raw.replace(/\\[([^\\[\\]]*)\\]\\s*\\\"(.*?)\\\"/gi,(m,g1,g2,o,s)=>{\n      let col = this.characters[g1.toLowerCase()]\n      if (this.bootstrapColors.indexOf(col) == -1)\n        return `<blockquote style=\"color: ${col}; border-left-color: ${col}\"><b>${g1}:</b> ${g2}</blockquote>`\n      return `<blockquote style=\"border-left-color: var(--${col})\" class=\"text-${col}\"><b>${g1}:</b> ${g2}</blockquote>`\n    })\n    raw = raw.replace(/\\[([^\\[\\]]*)\\]/gi,(m,g,o,s)=>{\n      let col = this.characters[g.toLowerCase()]\n      if (this.bootstrapColors.indexOf(col) == -1)\n        return `<span style=\"color: ${col}\"><b>${g}</b></span>`\n      return `<span class=\"text-${col}\"><b>${g}</b></span>`\n    })\n    return raw\n  }\n  render() {\n    if (!this.contentAnchor || !this.titleAnchor || !this.progressAnchor) {\n      console.log(\"Missing Anchors, Aborting render\");\n      return;\n    }\n    let chapter = this.chapters[this.currentChapter]\n    let renderedContent = this.markdownify(this.currentChapter)\n    this.contentAnchor.innerHTML = renderedContent\n    this.titleAnchor.innerText = `${this.currentChapter+1}. ${chapter.title}`\n    let p = (this.currentChapter+1)/this.chapters.length\n    p *= 100\n    p += \"%\"\n    this.progressAnchor.style.width = p\n    // set up jump links\n    let links = document.getElementsByClassName(\"jmp-link\");\n    for(let e of links) {\n      e.addEventListener(\"click\",()=>{\n        this.jump(parseInt(e.id.split(\"-\")[2])-1)\n      });\n    }\n  }\n  next() {\n    if (this.currentChapter >= this.chapters.length-1) return;\n    this.currentChapter++;\n    this.render();\n  }\n  prev() {\n    if (this.currentChapter <= 0) return;\n    this.currentChapter--;\n    this.render();\n  }\n  jump(ch) {\n    if (ch > this.chapters.length-1) return;\n    if (ch < 0) return;\n    this.currentChapter = ch;\n    this.render();\n  }\n}\n\nmodule.exports = Story\n","const tools = require('./Tools')\n\nclass Terminal {\n  constructor(inputAnchor,outputAnchor) {\n    this.output = outputAnchor\n    this.input = inputAnchor\n    this.scrollPos = 0;\n    this.playersDash = null;\n    this.commands = [\n      [/roll (\\d+) d(\\d+)/,this.rollDice],\n      [/r (\\d+) d(\\d+)/,this.rollDice],\n      [/clear/,this.clear],\n      [/test (.*)/,this.testCommand],\n      [/(\\w+) check for \\[([^\\[\\]]+)\\]/, this.statCheck]\n    ]\n    this.pos = null;\n    this.history = [];\n    this.input.addEventListener(\"keydown\",(event)=>this.registerKeyDown(event));\n  }\n  registerKeyDown(event) {\n    let key = event.keyCode || event.charCode;\n    // up/down\n    if (key == 38 || key == 40) {\n        if (this.history.length == 0) return;\n        if (key == 38) {\n          if (this.pos === null) this.pos = this.history.length-1\n          else if (this.pos > 0) this.pos--\n        } else {\n          if (this.pos === null) return;\n          else if (this.pos < this.history.length-1) this.pos++\n          else if (this.pos == this.history.length-1) {\n            this.pos = null;\n            this.input.value = \"\";\n            return;\n          }\n        }\n        this.input.value = this.history[this.pos]\n    } else {\n      this.pos = null;\n    }\n    // enter\n    if (key == 13)\n      this.execute()\n  }\n  writeOutput(t) {\n    let result = document.createElement(\"p\");\n    result.className = \"lead\";\n    result.style.fontSize = \"1rem\";\n    result.style.margin = \"0px\";\n    result.innerText = t;\n    this.output.appendChild(result);\n    this.scrollPos += result.clientHeight;\n    this.output.scrollTop = this.scrollPos;\n  }\n  writeError(t) {\n    let result = document.createElement(\"p\");\n    result.className = \"lead text-danger\";\n    result.style.fontSize = \"1rem\";\n    result.style.margin = \"0px\";\n    result.innerText = t;\n    this.output.appendChild(result);\n    this.scrollPos += result.clientHeight;\n    this.output.scrollTop = this.scrollPos;\n  }\n  execute() {\n    let cmd = this.input.value;\n    this.history.push(cmd);\n    cmd = cmd.toLowerCase().replace(/\\s+/,\" \");\n    let l = this.commands.map((x)=>[x[0].exec(cmd),x[1]]).filter((x)=>x[0]);\n    let m = null;\n    if(l.length > 0) m = l[0];\n    else this.writeError(\"Unknown Command\");\n    if (m) m[1].bind(this)(m[0].slice(1));\n    this.input.value = \"\";\n  }\n  autoType(execString) {\n    this.input.value = execString;\n    this.execute()\n  }\n  // commands\n\n  statCheck(args) {\n    let stat = args[0];\n    let player = args[1];\n    let character = this.playersDash.getCharacter(player);\n    if (!character) {\n      this.writeError(`Unknown Player '${player}'`);\n      return;\n    }\n    let base = tools.getRndInteger(1,20);\n    let abilityMod = character.abilityCheck(stat);\n    let saveMod = character.savingThrow(stat);\n    let abilityRoll = base + abilityMod;\n    let saveRoll = base + saveMod;\n    if (abilityMod >= 0) abilityMod = `+${abilityMod}`;\n    if (saveMod >= 0) saveMod = `+${saveMod}`;\n    this.writeOutput(`${player} ${stat} ability check:  ${abilityRoll} (${base}${abilityMod})`);\n    this.writeOutput(`${player} ${stat} saving throw:  ${saveRoll} (${base}${saveMod})`);\n  }\n  clear() {\n    this.output.innerHTML = \"\";\n    this.scrollPos = 0;\n  }\n\n  rollDice(args) {\n    let n = parseInt(args[0]);\n    let d = parseInt(args[1]);\n    let rolls = Array(n).fill(0).map((x)=>tools.getRndInteger(1,d));\n    if(n > 1) {\n       this.writeOutput(`${tools.sum(rolls)} (${rolls.join(\"+\")})`);\n       return;\n    }\n    this.writeOutput(tools.sum(rolls));\n  }\n  \n  testCommand(args) {\n    if (args[0] == \"throw\") {\n      let modalVDN = tools.makeDivVDN();\n      modalVDN.addText(\"h1\",\"LOL\",\"lead\",\"1rem\");\n      tools.throwModal(modalVDN);\n    }\n  }\n}\n\nmodule.exports = Terminal;\n","function watched(o,change) {\n  let handler = {\n    set: (obj,prop,value) => {\n      obj[prop]=value\n      change(obj)\n    }\n  }\n  return new Proxy(o,handler)\n}\n\nfunction VDN(tagName) {\n  return {\n    style: {},\n    root:{},\n    attributes: {},\n    children: [],\n    events: {},\n    tag: tagName,\n    get first() {\n      return this.children[0];\n    },\n    get second() {\n      return this.children[1];\n    },\n    setDim(w,h) {\n        this.style.width = w\n        this.style.height = h\n        return this\n    },\n    setMargin({left,right,top,bottom} = {left: \"0rem\",right: \"0rem\",top: \"0rem\",bottom: \"0rem\"}) {\n      this.style.marginLeft = left\n      this.style.marginRight = right\n      this.style.marginTop = top\n      this.style.marginBottom = bottom\n      return this\n    },\n    addChild(c) {\n      this.children.push(c)\n      return this\n    },\n    addText(tag,text,className,size) {\n      let t = VDN(tag);\n      t.root.innerHTML = text;\n      t.style.fontSize = size;\n      t.root.className = className;\n      t.style.margin = \"0px\";\n      this.addChild(t);\n      return this;\n    },\n    bind(e,handler){\n      this.events[e] = handler;\n    },\n    render() {\n      let e = document.createElement(this.tag);\n      for (let k in this.attributes)\n        e.setAttribute(k,this.attributes[k]);\n      for (let k in this.style)\n        e.style[k]=this.style[k];\n      for (let k in this.root)\n        e[k]=this.root[k];\n      for (let child of this.children)\n        e.appendChild(child.render());\n      for (let k in this.events)\n        e.addEventListener(k,this.events[k]);\n      return e\n    }\n  }\n}\n\nfunction makeDivVDN({className} = {className:\"\"}) {\n  let d = VDN(\"div\")\n  d.root.className = className\n  return d\n}\n\nfunction makeFlexVDN(dir,jc,ai) {\n  let div = VDN(\"div\")\n  div.style.display = \"flex\"\n  div.style.flexDirection = dir\n  div.style.justifyContent = jc\n  div.style.alignItems = ai\n  return div\n}\n\nfunction makeIconVDN(i,tt) {\n  let a = VDN(\"a\")\n  a.attributes[\"data-balloon\"] = tt\n  a.attributes[\"data-balloon-pos\"] = \"up\"\n  let icon = VDN(\"i\")\n  icon.root.className = \"mdi mdi-\"+i\n  icon.style.color = \"#777\"\n  icon.style.fontSize = \"0.9rem\"\n  a.addChild(icon)\n  return a\n}\n\nfunction getRndInteger(min, max) {\n    max+=1;\n    return Math.floor(Math.random() * (max - min) ) + min;\n}\n\nfunction sum(l) {\n  return l.reduce((v,a)=>a+v)\n}\n\nfunction closeModal() {\n  let toDie = document.getElementById(\"thrownModal\");\n  toDie.style.display = \"none\";\n  document.body.removeChild(toDie);\n  document.getElementById(\"filter\").style.display = \"none\";\n}\n\nfunction throwModal(m) {\n  if (document.getElementById(\"thrownModal\") === undefined) return;\n  document.getElementById(\"filter\").style.display = \"block\";\n  let container = makeDivVDN({className: \"thrown-modal\"});\n  container.root.id = \"thrownModal\";\n  let top = makeDivVDN({className:\"header\"})\n  let bottom = makeDivVDN({className:\"content\"})\n  let i = makeIconVDN(\"close\",\"close\");\n  i.bind(\"click\",closeModal);\n  i.root.className = \"hoverable\";\n  i.children[0].style.fontSize = \"1.2rem\"\n  i.attributes[\"data-balloon-pos\"] = \"left\";\n  top.addChild(i);\n  bottom.addChild(m);\n  container.addChild(top);\n  container.addChild(bottom);\n  container.style.padding = \"1rem\";\n  document.body.appendChild(container.render());\n}\n\nmodule.exports = {\n  VDN: VDN,\n  makeDivVDN: makeDivVDN,\n  makeFlexVDN: makeFlexVDN,\n  makeIconVDN: makeIconVDN,\n  watched: watched,\n  sum: sum,\n  getRndInteger: getRndInteger,\n  throwModal: throwModal,\n  closeModal: closeModal\n}\n","const tools = require('./Tools')\nconst Story = require('./Story')\nconst test_story = require('./data/test_story.json')\nconst Terminal = require('./Terminal')\nconst PlayersDash = require('./PlayersDash')\nconst Character = require('./Character')\nconst characters = require('./data/test_characters.json')\n\n// globals\nlet story = null;\nlet terminal = null;\nlet playersDash = null;\n\nfunction storyDriver(){\n  let content = document.getElementById(\"story-content\");\n  let title = document.getElementById(\"story-title\");\n  let progress = document.getElementById(\"story-progress\");\n  story = new Story(content,title,progress);\n  story.loadFromJson(test_story);\n  document.getElementById(\"chapter-next\").addEventListener(\"click\",()=>story.next());\n  document.getElementById(\"chapter-previous\").addEventListener(\"click\",()=>story.prev());\n  story.render();\n}\n\nfunction terminalDriver(){\n  let input = document.getElementById(\"terminal-input\");\n  let output = document.getElementById(\"terminal-output\");\n  terminal = new Terminal(input,output);\n}\n\nfunction playersDashDriver(){\n  let cards = ['character-left','character-middle','character-right'];\n  cards = cards.map((x)=>document.getElementById(x));\n  // TODO: remove cross dependency (kinda ruins encapsulation)\n  playersDash = new PlayersDash(cards,terminal);\n  terminal.playersDash = playersDash;\n  characters.map((x)=>{\n    let c = new Character();\n    c.buildFromJson(x);\n    playersDash.newCharacter(c);\n  });\n}\n// init\nfunction init() {\n  storyDriver();\n  terminalDriver();\n  playersDashDriver();\n  let dev = true;\n\n  // hot reloading\n  if(dev) {\n    const socket = io.connect('http://127.0.0.1:5000');\n    socket.on('message', function() {\n        console.log(\"TIME FOR A CHEEKY RELOAD LADS\");\n    });\n  }\n}\n\nwindow.onload = init;\n"],"sourceRoot":""}